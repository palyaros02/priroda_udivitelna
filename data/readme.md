### Добро пожаловать на кейс Минприроды "Животные"!
*** 
В представленном архиве вы можете увидеть следующие папки и файлы

1. Папка **traps** --- датасет из фотографий фотоловушек.
2. Файл **registration.csv** --- файл, содержащий, информацию о регистрациях по фотографиям. Названия столбцов говорящие за исключением *class_predict* и *registration_class*. Первый столбец --- прогнозируемый класс с помощью некоторой модели, второй --- постобработанный класс для унификации данных в рамках одной регистрации.
3. Файл **sample_submission.csv** --- формат выдачи регистраций для автоматической проверки. Отметим, что под *count* подразумевается максимальное число животных.

***

### Вашей задачей будет разработка модели, осуществляющей регистрацию появлений животных, а именно временных интервалов, видов животных и их количества.

На основе имеющихся фотографий с различных фотоловушек, необходимо находить разработать модель регистрации животных. В моделей распознавания животных предлагается использовать https://github.com/Vlad188-1/Hack_2024. Не забудьте про технические и отраслевые критерии.

Проверка будет осуществляться с помощью автоматической проверки метрики по файлу, аналогичному **sample_submission.csv**, которая вычисляется следующим образом:  

1. Для каждой фотоловушки и каждого вида животных выделяются отрезки регистрации.
2. Отрезки регистрации из решения сравниваются с эталонными отрезками регистрации за счет последовательного сопоставления отрезков из двух упорядоченных список по времени начала регистрации.  
3. Отрезки считаются соответствующими друг другу, если пересечение оказывается ненулевым.
    3.1. Тогда расчитывается IoU отрезков.  
    3.2. Сравниваются количества животных из решения и эталонного примера.  
    3.3. Отрезки далее не участвуют при сравнении остальных отрезков.
4. Если пара оказывается не соответствующей (пустое пересечение), то:  
    4.1. Если отрезок из решения идет позже текущего эталонного, то выбирается следующий эталонный.  
    4.2. Если случается обратная ситуация, то есть предложен лишний отрезок решением,  это запоминается, чтобы внести штраф далее. Выбирается следующий отрезок из решения.
5. Итоговые IoU суммируются и делятся на общее число эталонных регистраций, а также домножаются на F1-score по количествам животных из сопоставленных пар с усреднением weighted по классам 1, 2, 3, 4, 5 (под 5 подразумевается 5 и более животных).
6. Из полученного скора вычитаются ошибочные предложения с весом 0.5 (то есть, если есть два предложенных в решении отрезка, один совпал целиком, второй - нет, то итоговый скор будет 0.5 = 1 - 0.5).

**ВАЖНО!!!** Решение сдается на автоматическую проверку в формате .csv.
**ВАЖНО!!!** Обязательно проверьте разделители, заголовки и столбцы, они должны быть аналогичны формату sample_submission.csv. Проверьте также, что начальные моменты времени регистраций меньше или равны конечных моментов.

#### Пример расчета
Для эталонной таблицы
|folder_name|class|date_registration_start|date_registration_end|count|
|-----------|-----|-----------------------|---------------------|-----|
|10         |Deer |2023-01-02 18:32:33    |2023-01-02 18:33:33  |3    |
|10         |Deer |2023-01-02 20:32:33    |2023-01-02 20:33:33  |1    |

и таблицы решения

|folder_name|class|date_registration_start|date_registration_end|count|
|-----------|-----|-----------------------|---------------------|-----|
|10         |Deer |2023-01-02 18:32:33    |2023-01-02 18:32:33  |3    |
|10         |Deer |2023-01-02 19:39:33    |2023-01-02 19:40:03  |1    |
|10         |Deer |2023-01-02 20:32:33    |2023-01-02 20:33:33  |2    |

расчет будет следующий:

1. Первая строка эталонной таблицы и певрая таблицы решения пересекутся.
2. Вторые строки не пересекутся. В таблице решения будет выбрана следующая.
3. Вторая строка эталонной и третья решения таблиц пересекутся.
4. Доля найденных составит 2/2, но f-score по count составит 0.5. 
5. Ошибка была одна, она войдет в качестве штрафа 1/2 (где 2 --- количество эталонных регистраций) с весом 0.5, таким образом вычитая из итогового скора 0.25.
6. Итоговое значение метрики - 0.25

# ЖЕЛАЕМ УДАЧИ!

P.S. Не забудьте посетить экспертные сессии и не стесняйтесь задавать вопросы)